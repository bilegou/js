<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>三级联动</title>
    <script src="js/jquery-1.6.4.min.js" type="text/javascript"></script>
    <script src="js/main.js" type="text/javascript"></script>
</head>
<body>
<p>省份</p>
<select id="province" onchange="javascript:getProvince()">
    <option name="option1" value="">请选择</option>
</select>

<p>城市</p>
<select id="city" onchange="getCity()">
    <option name="option2" >请选择</option>
</select>

<p>区、县</p>
<select id="county">
    <option name="option3">请选择</option>
</select>

</body>
</html>

<script>

    function fun2() {


    }

    function getProvince() {

        $.ajax({
            url: 'http://120.77.174.30/api/City/getProvince',
            dataType:'json',
            type:'post',
            data:{},
            async:true,

            success:function (json) {

                list_html = '';
                list_html += '<option name="option1" value="">请选择省</option>';
                for(key in json){
                    node = json[key];
                    list_html += '<option name="option1" value= "'+ node.zone_id +'" >' + node.name +'</option>';
                }
                $('#province').html(list_html);

            },
            error: function (xhr, ajaxOptions, thrownError) {
                alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
            }

        });


    }

    function getCity() {

        province_id = $('#option1');
        opt = province_id[0];
        id = opt[opt.selectedIndex].value;

        $.ajax({
            url: 'http://120.77.174.30/api/City/getCity',
            dataType:'json',
            type:'post',
            data:{'province_id':id},
            async:true,

            success:function (json) {

                list_html = '';
                list_html += '<option name="option2" value="">请选择省</option>';
                for(key in json){
                    node = json[key];
                    list_html += '<option name="option2" value= "'+ node.city_id +'" >' + node.name +'</option>';
                }
                $('#city').html(list_html);

            },
            error: function (xhr, ajaxOptions, thrownError) {
                alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
            },

        });


    }

    function getCounty() {



    }


    $(document).ready(function () {
        getProvince();
    });

</script>